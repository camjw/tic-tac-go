
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">github.com/camjw/tic-tac-go/lib/board.go (100.0%)</option>
				
				<option value="file1">github.com/camjw/tic-tac-go/lib/computer_player.go (100.0%)</option>
				
				<option value="file2">github.com/camjw/tic-tac-go/lib/helpers.go (55.6%)</option>
				
				<option value="file3">github.com/camjw/tic-tac-go/lib/player.go (100.0%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package lib

import "fmt"

type Board struct {
        Grid       [3][3]string
        TotalMoves int
        NextTurn   string
}

func NewBoard(symbol string) *Board <span class="cov8" title="1">{
        EmptyGrid := [3][3]string{
                {"-", "-", "-"},
                {"-", "-", "-"},
                {"-", "-", "-"},
        }
        return &amp;Board{EmptyGrid, 0, symbol}
}</span>

func (b Board) WhoseTurn() string <span class="cov8" title="1">{
        return b.NextTurn
}</span>

func (b Board) Print() <span class="cov8" title="1">{
        for i := range b.Grid </span><span class="cov8" title="1">{
                fmt.Println(b.Grid[i])
        }</span>
}

func (b *Board) SwitchPlayer() <span class="cov8" title="1">{
        if b.WhoseTurn() == "X" </span><span class="cov8" title="1">{
                b.NextTurn = "O"
        }</span> else<span class="cov8" title="1"> {
                b.NextTurn = "X"
        }</span>
}

func (b *Board) PlayMove(index int, symbol string) <span class="cov8" title="1">{
        row, column := index/3, index%3
        b.Grid[row][column] = symbol
        b.TotalMoves += 1
        b.SwitchPlayer()
}</span>

func (b *Board) GetValidMoves() []int <span class="cov8" title="1">{
        output := []int{}
        for i := range b.Grid </span><span class="cov8" title="1">{
                for j := range b.Grid[i] </span><span class="cov8" title="1">{
                        if b.Grid[i][j] == "-" </span><span class="cov8" title="1">{
                                output = append(output, 3*i+j)
                        }</span>
                }
        }
        <span class="cov8" title="1">if b.GameOver() </span><span class="cov8" title="1">{
                return []int{}
        }</span>
        <span class="cov8" title="1">return output</span>
}

func (b Board) Winner(symbol string) bool <span class="cov8" title="1">{
        if b.VerticalWin(symbol) || b.HorizontalWin(symbol) || b.DiagonalWin(symbol) </span><span class="cov8" title="1">{
                return true
        }</span>
        <span class="cov8" title="1">return false</span>
}

func (b Board) GameOver() bool <span class="cov8" title="1">{
        if b.Winner("X") || b.Winner("O") || b.TotalMoves == 9 </span><span class="cov8" title="1">{
                return true
        }</span>
        <span class="cov8" title="1">return false</span>
}

func (b Board) VerticalWin(symbol string) bool <span class="cov8" title="1">{
        for i := 0; i &lt; 3; i++ </span><span class="cov8" title="1">{
                column := [3]string{b.Grid[0][i], b.Grid[1][i], b.Grid[2][i]}
                if column == [3]string{symbol, symbol, symbol} </span><span class="cov8" title="1">{
                        return true
                }</span>
        }
        <span class="cov8" title="1">return false</span>
}

func (b Board) HorizontalWin(symbol string) bool <span class="cov8" title="1">{
        for i := 0; i &lt; 3; i++ </span><span class="cov8" title="1">{
                row := b.Grid[i]
                if row == [3]string{symbol, symbol, symbol} </span><span class="cov8" title="1">{
                        return true
                }</span>
        }
        <span class="cov8" title="1">return false</span>
}

func (b Board) DiagonalWin(symbol string) bool <span class="cov8" title="1">{
        ddiag := [3]string{b.Grid[0][0], b.Grid[1][1], b.Grid[2][2]}
        udiag := [3]string{b.Grid[0][2], b.Grid[1][1], b.Grid[2][0]}
        winner := [3]string{symbol, symbol, symbol}
        if udiag == winner || ddiag == winner </span><span class="cov8" title="1">{
                return true
        }</span>
        <span class="cov8" title="1">return false</span>
}

func (b Board) Clone() Board <span class="cov8" title="1">{
        return b
}</span>
</pre>
		
		<pre class="file" id="file1" style="display: none">package lib

type ComputerPlayer struct {
        Symbol   string
        Board    BoardToPlay
        NextMove int
}

func NewComputer(board BoardToPlay) *ComputerPlayer <span class="cov8" title="1">{
        return &amp;ComputerPlayer{"O", board, -1}
}</span>

func (c *ComputerPlayer) ComputerMove() <span class="cov8" title="1">{
        c.miniMax(c.Board)
        c.Board.PlayMove(c.NextMove, c.Symbol)
}</span>

func (c ComputerPlayer) score(game BoardToPlay) float64 <span class="cov8" title="1">{
        if game.Winner("O") </span><span class="cov8" title="1">{
                return 1.0
        }</span> else<span class="cov8" title="1"> if game.Winner("X") </span><span class="cov8" title="1">{
                return -1.0
        }</span> else<span class="cov8" title="1"> {
                return 0.0
        }</span>
}

func (c *ComputerPlayer) miniMax(board BoardToPlay) float64 <span class="cov8" title="1">{
        if board.GameOver() </span><span class="cov8" title="1">{
                return c.score(board)
        }</span>

        <span class="cov8" title="1">scores := []float64{}
        moves := []int{}

        for _, move := range board.GetValidMoves() </span><span class="cov8" title="1">{
                possible_board := board.Clone()
                possible_board.PlayMove(move, possible_board.WhoseTurn())
                scores = append(scores, 0.9 * c.miniMax(&amp;possible_board))
                moves = append(moves, move)
        }</span>

        <span class="cov8" title="1">return c.scorePosition(board, moves, scores)</span>
}

func (c *ComputerPlayer) scorePosition(board BoardToPlay, moves []int, scores []float64) float64 <span class="cov8" title="1">{
        if board.WhoseTurn() == "O" </span><span class="cov8" title="1">{
                max_score_index := indexInSlice(scores, maxFloat64Slice(scores))
                c.NextMove = moves[max_score_index]
                return scores[max_score_index]
        }</span> else<span class="cov8" title="1"> {
                min_score_index := indexInSlice(scores, minFloat64Slice(scores))
                c.NextMove = moves[min_score_index]
                return scores[min_score_index]
        }</span>
}
</pre>
		
		<pre class="file" id="file2" style="display: none">package lib

import (
  "fmt"
  "strconv"
  "sort"
)

func intInSlice(a int, list []int) bool <span class="cov8" title="1">{
    for _, b := range list </span><span class="cov8" title="1">{
        if b == a </span><span class="cov8" title="1">{
            return true
        }</span>
    }
    <span class="cov8" title="1">return false</span>
}

func getUserInput(board BoardToPlay) string <span class="cov0" title="0">{
        var input string
        fmt.Println("Valid moves: ", board.GetValidMoves())
        fmt.Print("Choose move!\n")
        fmt.Scanln(&amp;input)
        return input
}</span>

func GetMove(board BoardToPlay) int <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                move, err := strconv.Atoi(getUserInput(board))
                if (err == nil) &amp;&amp; (intInSlice(move, board.GetValidMoves())) </span><span class="cov0" title="0">{
                        return move
                        break</span>
                }
    <span class="cov0" title="0">GetMove(board)</span>
        }
        <span class="cov0" title="0">return -1</span>
}

func minFloat64Slice(slice []float64) float64 <span class="cov8" title="1">{
        return orderFloat64Slice(slice)[0]
}</span>

func maxFloat64Slice(slice []float64) float64 <span class="cov8" title="1">{
  return orderFloat64Slice(slice)[len(slice)-1]
}</span>

func indexInSlice(slice []float64, value float64) int <span class="cov8" title="1">{
        for i, v := range slice </span><span class="cov8" title="1">{
                if v == value </span><span class="cov8" title="1">{
                        return i
                }</span>
        }
        <span class="cov8" title="1">return -1</span>
}

func orderFloat64Slice(slice []float64) []float64 <span class="cov8" title="1">{
        output := []float64{}
        for _, value := range slice </span><span class="cov8" title="1">{
                output = append(output, value)
        }</span>
        <span class="cov8" title="1">sort.Float64s(output)
        return output</span>
}
</pre>
		
		<pre class="file" id="file3" style="display: none">package lib

type Player struct {
        Symbol string
        Board  BoardToPlay
}

func NewPlayer(board BoardToPlay) *Player <span class="cov8" title="1">{
        return &amp;Player{"X", board}
}</span>

func (p *Player) PlayerMove(index int) <span class="cov8" title="1">{
        p.Board.PlayMove(index, p.Symbol)
}</span>
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
